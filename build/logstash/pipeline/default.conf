input {
    udp {
        port => 1984
    }
}

filter {
    json {
        source => "message"
    }

    if "_jsonparsefailure" in [tags] {
        mutate {
            add_field => {
                client => "error"
                metric => "metric_error"
            }
        }
    }
}

output {
    elasticsearch {
        hosts => ["http://172.20.56.158:9200"]
        index => ".measure-%{client}-%{+YYYY.MM.dd}"
        template => "/usr/share/logstash/config/tsuru-template.json"
        template_name => "tsuru-template"
    }
}
